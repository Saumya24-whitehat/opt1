function spiltDate(t) {
  var e = t.slice(0, 10),
    i = e.split("-"),
    n = { year: i[0], month: i[1], day: i[2] };
  return n;
}
function getLastTradingDate() {
  var t;
  return (
    $.ajax({
      type: "POST",
      url: "/opt/hcharts/stx8req/php/getLatestTradingDate_TV.php",
      async: !0,
      success: function (e) {
        t = e.trim();
      },
    }),
    t
  );
}

function getAdjustedDate() {
    var today = new Date();
    
    if (today.getDay() === 0 /* Sunday */ || today.getDay() === 6 /* Saturday */) {
        today.setDate(today.getDate() - (today.getDay() === 0 ? 2 : 1));
    }

    var formattedDate = today.toISOString().slice(0, 10);

    return formattedDate;
}

function getPreviousDayOHLC(t) {
  var e = [];
  return (
    $.ajax({
      type: "POST",
      url: "/opt/hcharts/stx8req/php/getPreviousDayOHLC_TV.php",
      async: !1,
      data: { symbol: t },
      success: function (t) {
        var i = JSON.parse(t);
        e.push(i);
      },
    }),
    e
  );
}
function CPR_with_Pivots_Backup(i) {
  return {
    name: "CPR with Pivots",
    metainfo: {
      _metainfoVersion: 27,
      isTVScript: !1,
      isTVScriptStub: !1,
      is_hidden_study: !1,
      showLabel: !0,
      is_price_study: !0,
      defaults: {
        styles: {
          plot_0: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#00008B",
          },
          plot_1: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#8B0000",
          },
          plot_2: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#006400",
          },
          plot_3: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#90EE90",
          },
          plot_4: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#FF0000",
          },
          plot_5: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#ADD8E6",
          },
          plot_6: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#FFA500",
          },
          plot_7: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#00FFFF",
          },
          plot_8: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#FF00FF",
          },
        },
        precision: 2,
        inputs: { in_0: "Daily" },
      },
      plots: [
        { id: "plot_0", type: "line" },
        { id: "plot_1", type: "line" },
        { id: "plot_2", type: "line" },
        { id: "plot_3", type: "line" },
        { id: "plot_4", type: "line" },
        { id: "plot_5", type: "line" },
        { id: "plot_6", type: "line" },
        { id: "plot_7", type: "line" },
        { id: "plot_8", type: "line" },
      ],
      styles: {
        plot_0: { title: "Pivot", histogramBase: 0, joinPoints: !1 },
        plot_1: { title: "BC", histogramBase: 0, joinPoints: !1 },
        plot_2: { title: "TC", histogramBase: 0, joinPoints: !1 },
        plot_3: { title: "R1", histogramBase: 0, joinPoints: !1 },
        plot_4: { title: "S1", histogramBase: 0, joinPoints: !1 },
        plot_5: { title: "R2", histogramBase: 0, joinPoints: !1 },
        plot_6: { title: "S2", histogramBase: 0, joinPoints: !1 },
        plot_7: { title: "R3", histogramBase: 0, joinPoints: !1 },
        plot_8: { title: "S3", histogramBase: 0, joinPoints: !1 },
      },
      description: "CPR with Pivots (iCharts)",
      shortDescription: "CPR with Pivots (iCharts) ",
      inputs: [
        {
          id: "in_0",
          name: "Pivots Timeframe",
          defval: "Monthly",
          type: "text",
          options: ["Daily"],
        },
      ],
      id: "CPR with Pivots@tv-basicstudies-1",
      scriptIdPart: "",
      name: "CPR with Pivots",
    },
    constructor: function () {
      (this.f_0 = function (e) {
        var t = this._context.new_var(e);
        return this._context.new_var(t.get(1));
      }),
        (this.f_1 = function (e) {
          return "Daily" === e
            ? "D"
            : "Weekly" === e
            ? "W"
            : "Monthly" === e
            ? "M"
            : "Yearly" === e
            ? "12M"
            : void 0;
        }),
        (this.init = function (n, t) {
          (this._values = []), (this._context = n), (this._input = t);
          var e = i.Std.ticker(this._context),
            o = i.Std.time(this._context);
          (PreviousDayOHLC = getPreviousDayOHLC(e)),
            this._context.new_sym(
              e,
              i.Std.period(this._context),
              i.Std.period(this._context)
            );
        }),
        (this.main = function (n, t) {
          (this._context = n), (this._input = t);
          var e, o, l, s, r, p, c, a, d, _, h, y, m, u, x, S, v;
          (e = i.Std.time(this._context)),
            isNaN(i.Std.time(this._context)) ||
              ((o = new Date(e).toISOString().split("T")[0]),
              (l = PreviousDayOHLC[0][o].prev_open),
              (s = PreviousDayOHLC[0][o].prev_high),
              (r = PreviousDayOHLC[0][o].prev_low),
              (p = PreviousDayOHLC[0][o].prev_close),
              (c = (parseFloat(s) + parseFloat(r) + parseFloat(p)) / 3),
              (a = (parseFloat(s) + parseFloat(r)) / 2),
              (d = c - a + c),
              (_ = parseFloat(s)),
              (h = parseFloat(r)),
              (m = 2 * c - h),
              (y = 2 * c - _),
              (x = c + (m - y)),
              (u = c - (m - y)),
              (v = c + (x - u)),
              (S = c - (x - u)));
          var g, P, C, w, b, f, I, M, A, V, k;
          return (
            (c = void 0 === c ? NaN : c),
            (a = void 0 === a ? NaN : a),
            (d = void 0 === d ? NaN : d),
            (_ = void 0 === _ ? NaN : _),
            (h = void 0 === h ? NaN : h),
            (m = void 0 === m ? NaN : m),
            (y = void 0 === y ? NaN : y),
            (x = void 0 === x ? NaN : x),
            (u = void 0 === u ? NaN : u),
            (v = void 0 === v ? NaN : v),
            (S = void 0 === S ? NaN : S),
            (g = c),
            (C = a),
            (P = d),
            (w = _),
            (b = h),
            (I = m),
            (f = y),
            (A = x),
            (M = u),
            (k = v),
            (V = S),
            [g, C, P, I, f, A, M, k, V]
          );
        });
    },
  };
}
function Anchored_VWAP_BeforeMultipleSymbolsIssue(i) {
  return (
    (getLastTradingDate = getLastTradingDate()),
    (datearr = spiltDate(getLastTradingDate)),
    (default_year_val = datearr.year),
    (default_month_val = datearr.month),
    (default_day_val = datearr.day),
    {
      name: "Anchored VWAP",
      metainfo: {
        _metainfoVersion: 40,
        isTVScript: !1,
        isTVScriptStub: !1,
        is_hidden_study: !1,
        linkedToSeries: !0,
        trackPrice: !0,
        is_price_study: !0,
        defaults: {
          styles: { plot: { plottype: 0, visible: !0, transparency: "0" } },
          inputs: {
            Src_id: "hlc3",
            Year_id: default_year_val,
            Month_id: default_month_val,
            Day_id: default_day_val,
            Hour_id: "09",
            Minute_id: "15",
          },
        },
        plots: [{ id: "plot", type: "line" }],
        description: "Anchored VWAP (iCharts)",
        shortDescription: "Anchored VWAP (iCharts)",
        inputs: [
          { id: "Src_id", name: "Src", type: "source" },
          {
            id: "Year_id",
            name: "Year",
            title: "Year",
            type: "integer",
            min: 1,
            max: 2099,
          },
          {
            id: "Month_id",
            name: "Month",
            title: "Month",
            type: "integer",
            min: 1,
            max: 12,
            step: 1,
          },
          {
            id: "Day_id",
            name: "Day",
            title: "Day",
            type: "integer",
            min: 1,
            max: 31,
            step: 1,
          },
          {
            id: "Hour_id",
            name: "Hour",
            title: "Hour",
            type: "integer",
            min: 0,
            max: 23,
            step: 1,
          },
          {
            id: "Minute_id",
            name: "Minute",
            title: "Minute",
            type: "integer",
            min: 0,
            max: 59,
            step: 1,
          },
        ],
        id: "Anchored VWAP@tv-basicstudies-1",
        scriptIdPart: "",
      },
      constructor: function () {
        (this.f_0 = function (e) {
          var t = this._context.new_var(e);
          return this._context.new_var(t.get(1));
        }),
          (this.f_1 = function (e) {
            return "open" === e
              ? "open"
              : "high" === e
              ? "high"
              : "low" === e
              ? "low"
              : "close" === e
              ? "close"
              : "h12" === e
              ? "h12"
              : "h1c3" === e
              ? "h1c3"
              : "ohlc4" === e
              ? "ohlc4"
              : "h1c3";
          }),
          (this.init = function (n, t) {
            (this._context = n),
              (this._input = t),
              (this._values = []),
              (firstvaluesArr = []),
              (volumevaluesArr = []),
              (getallvaluesArr = []),
              (timeArr = []),
              (return_val = [0]),
              (test1 = 0),
              (test2 = 0),
              (pinecum_vol2 = 0),
              (start = !1),
              this._context.new_sym(
                i.Std.ticker(this._context),
                i.Std.period(this._context),
                i.Std.period(this._context)
              );
          }),
          (this.main = function (n, t) {
            (this._context = n), (this._input = t);
            var e,
              o,
              l,
              s,
              r,
              p = t(0),
              c = t(1),
              a = t(2),
              d = t(3),
              _ = t(4),
              h = t(5);
            "open" == p && (r = i.Std.open(this._context)),
              "high" == p && (r = i.Std.high(this._context)),
              "low" == p && (r = i.Std.low(this._context)),
              "close" == p && (r = i.Std.close(this._context)),
              "hl2" == p && (r = i.Std.hl2(this._context)),
              "hlc3" == p && (r = i.Std.hlc3(this._context)),
              "ohlc4" == p && (r = i.Std.ohlc4(this._context));
            var y = new Date(Date.UTC(c, a - 1, d, _, h)),
              m = y.getTime(),
              u = new Date(new Date(m).getTime() + -19800000),
              x = u.getTime(),
              S = this._values.length;
            isNaN(i.Std.time(this._context)) ||
              this._values.push(i.Std.time(this._context));
            var v = Math.min.apply(null, this._values),
              g = Math.max.apply(null, this._values);
            if (
              ((s = g), (start = !!(s >= x)), !isNaN(i.Std.time(this._context)))
            ) {
              (volumesrc = i.Std.volume(this._context)),
                start
                  ? (firstvaluesArr.push(r), volumevaluesArr.push(volumesrc))
                  : ((firstvaluesArr = []), (volumevaluesArr = []));
              var P = 0,
                C = 0;
              start &&
                (0 < firstvaluesArr.length && (P = firstvaluesArr[0]),
                0 < volumevaluesArr.length && (C = volumevaluesArr[0]),
                (e = r),
                (o = i.Std.volume(this._context)),
                (pinecum_src = i.Std.cum(e * o, this._context)),
                (pinecum_vol = i.Std.cum(o, this._context)),
                (testSrc = start ? pinecum_src + P * C : ""),
                (testVol = start ? pinecum_vol + C : ""),
                (l = testSrc / testVol));
            }
            return [l];
          });
      },
    }
  );
}
function OpenInterest(t) {
  return {
    name: "Open Interest",
    metainfo: {
      _metainfoVersion: 40,
      id: "Open Interest@tv-basicstudies-1",
      scriptIdPart: "",
      name: "OI",
      description: "Open Interest (iCharts)",
      shortDescription: "Open Interest (iCharts)",
      is_hidden_study: !1,
      is_price_study: !1,
      isCustomIndicator: !1,
      plots: [
        { id: "OI_Color", type: "line" },
        { id: "MA_Color", type: "line" },
      ],
      defaults: {
        styles: {
          OI_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "red",
          },
          MA_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "blue",
          },
        },
        precision: 1,
        inputs: {
          periodsLength: 14,
          method_id: "Simple",
          EnableMovingAverage_id: !1,
        },
      },
      styles: {
        OI_Color: { title: "OI Color", type: "line" },
        MA_Color: { title: "MA Color", type: "line" },
      },
      inputs: [
        {
          id: "method_id",
          type: "text",
          name: "Method",
          defval: "Simple",
          options: ["Simple", "Exponential", "Weighted"],
        },
        {
          id: "periodsLength",
          type: "integer",
          name: "periods Length",
          defval: 14,
          min: 1,
          max: 1e3,
        },
        {
          id: "EnableMovingAverage_id",
          type: "bool",
          name: "Enable Moving Average",
          defval: !1,
        },
      ],
    },
    constructor: function () {
      (this.init = function (e, i) {
        (this._context = e), (this._input = i);
        var n = t.Std.ticker(this._context) + "_OI";
        (prev = 0),
          (OpenInterest_value = 0),
          this._context.new_sym(
            n,
            t.Std.period(this._context),
            t.Std.period(this._context),
            prev,
            OpenInterest_value
          );
      }),
        (this.main = function (e, i) {
          (this._context = e), (this._input = i);
          var n = this._input(0),
            o = this._input(1),
            l = this._input(2);
          if (
            (this._context.select_sym(1),
            isNaN(prev) || (prev = OpenInterest_value),
            (prev = OpenInterest_value),
            (OpenInterest_value = isNaN(t.Std.close(this._context))
              ? prev
              : t.Std.close(this._context)),
            !isNaN(OpenInterest_value))
          )
            var s = this._context.new_var(OpenInterest_value);
          else var s = this._context.new_var(prev);
          if ("Simple" == n) var r = t.Std.sma(s, o, e);
          else if ("Exponential" == n) var r = t.Std.ema(s, o, e);
          else if ("Weighted" == n) var r = t.Std.wma(s, o, e);
          return !0 == l ? [OpenInterest_value, r] : [OpenInterest_value];
        });
    },
  };
}
function CumulativeOpenInterest(t) {
  return {
    name: "CombinedOpenInterest",
    metainfo: {
      _metainfoVersion: 40,
      id: "CumulativeOpenInterest@tv-basicstudies-1",
      scriptIdPart: "",
      name: "COI",
      description: "Combined Open Interest (iCharts)",
      shortDescription: "Combined Open Interest (iCharts)",
      is_hidden_study: !1,
      is_price_study: !1,
      isCustomIndicator: !1,
      plots: [
        { id: "OI_Color", type: "line" },
        { id: "MA_Color", type: "line" },
      ],
      defaults: {
        styles: {
          OI_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "red",
          },
          MA_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "blue",
          },
        },
        precision: 1,
        inputs: {
          periodsLength: 14,
          method_id: "Simple",
          EnableMovingAverage_id: !1,
        },
      },
      styles: {
        OI_Color: { title: "OI Color", type: "line" },
        MA_Color: { title: "MA Color", type: "line" },
      },
      inputs: [
        {
          id: "method_id",
          type: "text",
          name: "Method",
          defval: "Simple",
          options: ["Simple", "Exponential", "Weighted"],
        },
        {
          id: "periodsLength",
          type: "integer",
          name: "periods Length",
          defval: 14,
          min: 1,
          max: 1e3,
        },
        {
          id: "EnableMovingAverage_id",
          type: "bool",
          name: "Enable Moving Average",
          defval: !1,
        },
      ],
    },
    constructor: function () {
      (this.init = function (e, i) {
        (this._context = e), (this._input = i);
        var n = t.Std.ticker(this._context) + "_COI";
        (prev = 0),
          (OpenInterest_value = 0),
          this._context.new_sym(
            n,
            t.Std.period(this._context),
            t.Std.period(this._context),
            prev,
            OpenInterest_value
          );
      }),
        (this.main = function (e, i) {
          (this._context = e), (this._input = i);
          var n = this._input(0),
            o = this._input(1),
            l = this._input(2);
          if (
            (this._context.select_sym(1),
            isNaN(prev) || (prev = OpenInterest_value),
            (prev = OpenInterest_value),
            (OpenInterest_value = isNaN(t.Std.close(this._context))
              ? prev
              : t.Std.close(this._context)),
            !isNaN(OpenInterest_value))
          )
            var s = this._context.new_var(OpenInterest_value);
          else var s = this._context.new_var(prev);
          if ("Simple" == n) var r = t.Std.sma(s, o, e);
          else if ("Exponential" == n) var r = t.Std.ema(s, o, e);
          else if ("Weighted" == n) var r = t.Std.wma(s, o, e);
          return !0 == l ? [OpenInterest_value, r] : [OpenInterest_value];
        });
    },
  };
}
function Custom_RSI(t) {
  return {
    name: "Custom_RSI",
    metainfo: {
      _metainfoVersion: 27,
      isTVScript: !1,
      isTVScriptStub: !1,
      is_hidden_study: !1,
      defaults: {
        styles: {
          RSI_Color: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#0E47A0",
          },
          MA_Color: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#F24236",
          },
        },
        precision: 2,
        bands: [
          {
            color: "#398E3D",
            linestyle: 2,
            linewidth: 1,
            transparency: 0,
            visible: !0,
            value: 60,
          },
          {
            color: "#B51C1C",
            linestyle: 2,
            linewidth: 1,
            transparency: 0,
            visible: !0,
            value: 40,
          },
          {
            color: "#9598A1",
            linestyle: 2,
            linewidth: 1,
            transparency: 0,
            visible: !0,
            value: 50,
          },
        ],
        filledAreasStyle: {
          fill_0: { color: "#CEC7CD", transparency: 50, visible: !1 },
        },
        inputs: {
          method_id: "Simple",
          periodsLength: 14,
          periodsLength_MA: 20,
          EnableMovingAverage_id: !1,
        },
      },
      plots: [
        { id: "RSI_Color", type: "line" },
        { id: "MA_Color", type: "line" },
      ],
      styles: {
        RSI_Color: { title: "RSI Color", histogramBase: 0, joinPoints: !1 },
        MA_Color: { title: "MA Color", histogramBase: 0, joinPoints: !1 },
      },
      description: "Relative Strength Index (iCharts)",
      shortDescription: "RSI (iCharts)",
      is_price_study: !1,
      bands: [
        { id: "hline_0", name: "Upper Level" },
        { id: "hline_1", name: "Lower Level" },
        { id: "hline_mid", name: "Middle Level" },
      ],
      filledAreas: [
        {
          id: "fill_0",
          objAId: "hline_0",
          objCId: "hline_mid",
          objBId: "hline_1",
          type: "hline_hline",
          title: "HlinesBackground",
        },
      ],
      inputs: [
        {
          id: "method_id",
          type: "text",
          name: "Method",
          defval: "Simple",
          options: ["Simple", "Exponential", "Weighted"],
        },
        {
          id: "periodsLength",
          type: "integer",
          name: "periods (RSI)",
          defval: 14,
          min: 1,
          max: 1e3,
        },
        {
          id: "periodsLength_MA",
          type: "integer",
          name: "periods (MA)",
          defval: 20,
          min: 1,
          max: 1e3,
        },
        {
          id: "EnableMovingAverage_id",
          type: "bool",
          name: "Enable Moving Average",
          defval: !1,
        },
      ],
      id: "Custom_RSI@tv-basicstudies-1",
      scriptIdPart: "",
      name: "Custom_RSI",
    },
    constructor: function () {
      (this.init = function (e, i) {
        (this._context = e), (this._input = i);
        var n = t.Std.ticker(this._context);
        this._context.new_sym(
          n,
          t.Std.period(this._context),
          t.Std.period(this._context)
        );
      }),
        (this.f_1 = function (e, i, n) {
          var o = n.new_var(t.Std.max(t.Std.change(e), 0));
          return t.Std.rma(o, i, n);
        }),
        (this.f_2 = function (e, i, n) {
          var o = n.new_var(-t.Std.min(t.Std.change(e), 0));
          return t.Std.rma(o, i, n);
        }),
        (this.f_3 = function (e, i, n) {
          var o = n.new_var(t.Std.min(t.Std.change(e), 0));
          return t.Std.rma(o, i, n);
        }),
        (this.main = function (e, i) {
          (this._context = e), (this._input = i);
          var n = this._input(0),
            o = this._input(1),
            l = this._input(2),
            s = this._input(3),
            r = t.Std.close(this._context),
            p = o,
            c = this._context.new_var(r);
          let a;
          try {
            a = t.Std.rsi(
              this.f_1(c, p, this._context),
              this.f_2(c, p, this._context),
              this.f_3(c, p, this._context)
            );
          } catch (t) {
            a = void 0;
          }
          var d = this._context.new_var(a);
          if ("Simple" == n) var _ = t.Std.sma(d, l, e);
          else if ("Exponential" == n) var _ = t.Std.ema(d, l, e);
          else if ("Weighted" == n) var _ = t.Std.wma(d, l, e);
          return !0 == s ? [a, _] : [a];
        });
    },
  };
}
function CPR_with_Pivots(i) {
  return {
    name: "CPR with Pivots",
    metainfo: {
      _metainfoVersion: 27,
      isTVScript: !1,
      isTVScriptStub: !1,
      is_hidden_study: !1,
      showLabel: !0,
      is_price_study: !0,
      defaults: {
        styles: {
          plot_0: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#00008B",
          },
          plot_1: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#8B0000",
          },
          plot_2: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "#006400",
          },
          plot_3: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#90EE90",
          },
          plot_4: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#FF0000",
          },
          plot_5: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#ADD8E6",
          },
          plot_6: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#FFA500",
          },
          plot_7: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#00FFFF",
          },
          plot_8: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !1,
            color: "#FF00FF",
          },
        },
        precision: 2,
        inputs: { in_0: "Daily" },
      },
      plots: [
        { id: "plot_0", type: "line" },
        { id: "plot_1", type: "line" },
        { id: "plot_2", type: "line" },
        { id: "plot_3", type: "line" },
        { id: "plot_4", type: "line" },
        { id: "plot_5", type: "line" },
        { id: "plot_6", type: "line" },
        { id: "plot_7", type: "line" },
        { id: "plot_8", type: "line" },
      ],
      styles: {
        plot_0: { title: "Pivot", histogramBase: 0, joinPoints: !1 },
        plot_1: { title: "BC", histogramBase: 0, joinPoints: !1 },
        plot_2: { title: "TC", histogramBase: 0, joinPoints: !1 },
        plot_3: { title: "R1", histogramBase: 0, joinPoints: !1 },
        plot_4: { title: "S1", histogramBase: 0, joinPoints: !1 },
        plot_5: { title: "R2", histogramBase: 0, joinPoints: !1 },
        plot_6: { title: "S2", histogramBase: 0, joinPoints: !1 },
        plot_7: { title: "R3", histogramBase: 0, joinPoints: !1 },
        plot_8: { title: "S3", histogramBase: 0, joinPoints: !1 },
      },
      description: "CPR with Pivots (iCharts)",
      shortDescription: "CPR with Pivots (iCharts) ",
      inputs: [
        {
          id: "in_0",
          name: "Pivots Timeframe",
          defval: "Monthly",
          type: "text",
          options: ["Daily"],
        },
      ],
      id: "CPR with Pivots@tv-basicstudies-1",
      scriptIdPart: "",
      name: "CPR with Pivots",
    },
    constructor: function () {
      (this.f_0 = function (e) {
        var t = this._context.new_var(e);
        return this._context.new_var(t.get(1));
      }),
        (this.f_1 = function (e) {
          return "Daily" === e
            ? "D"
            : "Weekly" === e
            ? "W"
            : "Monthly" === e
            ? "M"
            : "Yearly" === e
            ? "12M"
            : void 0;
        }),
        (this.init = function (n, t) {
          (this._values = []), (this._context = n), (this._input = t);
          var e = i.Std.ticker(this._context) + "_CPR";
          this._context.new_sym(
            e,
            i.Std.period(this._context),
            i.Std.period(this._context)
          );
        }),
        (this.main = function (n, t) {
          (this._context = n), (this._input = t);
          var e, o, l, s, r, p, c, a, d, _, h, y, m, u, x, S, v;
          (e = i.Std.time(this._context)),
            this._context.select_sym(1),
            isNaN(i.Std.time(this._context)) ||
              ((o = new Date(e).toISOString().split("T")[0]),
              (l = i.Std.open(this._context)),
              (s = i.Std.high(this._context)),
              (r = i.Std.low(this._context)),
              (p = i.Std.close(this._context)),
              (c = (parseFloat(s) + parseFloat(r) + parseFloat(p)) / 3),
              (a = (parseFloat(s) + parseFloat(r)) / 2),
              (d = c - a + c),
              (_ = parseFloat(s)),
              (h = parseFloat(r)),
              (m = 2 * c - h),
              (y = 2 * c - _),
              (x = c + (m - y)),
              (u = c - (m - y)),
              (v = c + (x - u)),
              (S = c - (x - u)));
          var g, P, C, w, b, f, I, M, A, V, k;
          return (
            (c = void 0 === c ? NaN : c),
            (a = void 0 === a ? NaN : a),
            (d = void 0 === d ? NaN : d),
            (_ = void 0 === _ ? NaN : _),
            (h = void 0 === h ? NaN : h),
            (m = void 0 === m ? NaN : m),
            (y = void 0 === y ? NaN : y),
            (x = void 0 === x ? NaN : x),
            (u = void 0 === u ? NaN : u),
            (v = void 0 === v ? NaN : v),
            (S = void 0 === S ? NaN : S),
            (g = c),
            (C = a),
            (P = d),
            (w = _),
            (b = h),
            (I = m),
            (f = y),
            (A = x),
            (M = u),
            (k = v),
            (V = S),
            [g, C, P, I, f, A, M, k, V]
          );
        });
    },
  };
}
function IV(t) {
  return {
    name: "IV",
    metainfo: {
      _metainfoVersion: 40,
      id: "IV@tv-basicstudies-1",
      scriptIdPart: "",
      name: "IV",
      description: "IV (iCharts)",
      shortDescription: "IV (iCharts)",
      is_hidden_study: !1,
      is_price_study: !1,
      isCustomIndicator: !1,
      plots: [{ id: "IV_Color", type: "line" }],
      defaults: {
        styles: {
          IV_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "red",
          },
        },
        precision: 2,
        inputs: {
          periodsLength: 14,
          method_id: "Simple",
          EnableMovingAverage_id: !1,
        },
      },
      styles: { IV_Color: { title: "IV Color", type: "line" } },
      inputs: [],
    },
    constructor: function () {
      (this.init = function (e, i) {
        (this._context = e), (this._input = i);
        var n = t.Std.ticker(this._context) + "_IV";
        (IV_prev_value = 0),
          (IV_value = 0),
          this._context.new_sym(
            n,
            t.Std.period(this._context),
            t.Std.period(this._context),
            IV_prev_value,
            IV_value
          );
      }),
        (this.main = function (e, i) {
          return (
            (this._context = e),
            (this._input = i),
            this._context.select_sym(1),
            isNaN(IV_prev_value) || (IV_prev_value = IV_value),
            (IV_prev_value = IV_value),
            (IV_value = isNaN(t.Std.close(this._context))
              ? IV_prev_value
              : t.Std.close(this._context)),
            [IV_value]
          );
        });
    },
  };
}
function PCR(t) {
  return {
    name: "PCR",
    metainfo: {
      _metainfoVersion: 40,
      id: "PCR@tv-basicstudies-1",
      scriptIdPart: "",
      name: "PCR",
      description: "PCR (iCharts)",
      shortDescription: "PCR (iCharts)",
      is_hidden_study: !1,
      is_price_study: !1,
      isCustomIndicator: !1,
      plots: [{ id: "PCR_Color", type: "line" }],
      defaults: {
        styles: {
          PCR_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "red",
          },
        },
        precision: 2,
        inputs: {},
      },
      styles: { PCR_Color: { title: "PCR Color", type: "line" } },
      inputs: [],
    },
    constructor: function () {
      (this.init = function (e, i) {
        (this._context = e), (this._input = i);
        var n = t.Std.ticker(this._context) + "_PCR";
        (PCR_prev_value = 0),
          (PCR_value = 0),
          this._context.new_sym(
            n,
            t.Std.period(this._context),
            t.Std.period(this._context),
            PCR_prev_value,
            PCR_value
          );
      }),
        (this.main = function (e, i) {
          return (
            (this._context = e),
            (this._input = i),
            this._context.select_sym(1),
            isNaN(PCR_prev_value) || (PCR_prev_value = PCR_value),
            (PCR_prev_value = PCR_value),
            (PCR_value = isNaN(t.Std.close(this._context))
              ? PCR_prev_value
              : t.Std.close(this._context)),
            [PCR_value]
          );
        });
    },
  };
}
function Anchored_VWAP_BeforeTimeZoneIssue(i) {
  return (
    (getLastTradingDate = getLastTradingDate()),
    (datearr = spiltDate(getLastTradingDate)),
    (default_year_val = datearr.year),
    (default_month_val = datearr.month),
    (default_day_val = datearr.day),
    {
      name: "Anchored VWAP",
      metainfo: {
        _metainfoVersion: 40,
        isTVScript: !1,
        isTVScriptStub: !1,
        is_hidden_study: !1,
        linkedToSeries: !0,
        trackPrice: !0,
        is_price_study: !0,
        defaults: {
          styles: { plot: { plottype: 0, visible: !0, transparency: "0" } },
          inputs: {
            Src_id: "close",
            Year_id: default_year_val,
            Month_id: default_month_val,
            Day_id: default_day_val,
            Hour_id: "09",
            Minute_id: "15",
          },
        },
        plots: [{ id: "plot", type: "line" }],
        description: "Anchored VWAP (iCharts)",
        shortDescription: "Anchored VWAP (iCharts)",
        inputs: [
          { id: "Src_id", name: "Src", type: "source" },
          {
            id: "Year_id",
            name: "Year",
            title: "Year",
            type: "integer",
            min: 1,
            max: 2099,
          },
          {
            id: "Month_id",
            name: "Month",
            title: "Month",
            type: "integer",
            min: 1,
            max: 12,
            step: 1,
          },
          {
            id: "Day_id",
            name: "Day",
            title: "Day",
            type: "integer",
            min: 1,
            max: 31,
            step: 1,
          },
          {
            id: "Hour_id",
            name: "Hour",
            title: "Hour",
            type: "integer",
            min: 0,
            max: 23,
            step: 1,
          },
          {
            id: "Minute_id",
            name: "Minute",
            title: "Minute",
            type: "integer",
            min: 0,
            max: 59,
            step: 1,
          },
        ],
        id: "Anchored VWAP@tv-basicstudies-1",
        scriptIdPart: "",
      },
      constructor: function () {
        (this.f_0 = function (e) {
          var t = this._context.new_var(e);
          return this._context.new_var(t.get(1));
        }),
          (this.f_1 = function (e) {
            return "open" === e
              ? "open"
              : "high" === e
              ? "high"
              : "low" === e
              ? "low"
              : "close" === e
              ? "close"
              : "h12" === e
              ? "h12"
              : "h1c3" === e
              ? "h1c3"
              : "ohlc4" === e
              ? "ohlc4"
              : "h1c3";
          }),
          (this.init = function (n, t) {
            (this._context = n),
              (this._input = t),
              (this._values = []),
              (firstvaluesArr = []),
              (volumevaluesArr = []),
              (getallvaluesArr = []),
              (timeArr = []),
              (return_val = [0]),
              (test1 = 0),
              (test2 = 0),
              (pinecum_vol2 = 0),
              (start = !1),
              this._context.new_sym(
                i.Std.ticker(this._context),
                i.Std.period(this._context),
                i.Std.period(this._context)
              );
          }),
          (this.main = function (n, t) {
            (this._context = n), (this._input = t);
            var e,
              o,
              l,
              s,
              r,
              p = t(0),
              c = t(1),
              a = t(2),
              d = t(3),
              _ = t(4),
              h = t(5);
            "open" == p && (r = i.Std.open(this._context)),
              "high" == p && (r = i.Std.high(this._context)),
              "low" == p && (r = i.Std.low(this._context)),
              "close" == p && (r = i.Std.close(this._context)),
              "hl2" == p && (r = i.Std.hl2(this._context)),
              "hlc3" == p && (r = i.Std.hlc3(this._context)),
              "ohlc4" == p && (r = i.Std.ohlc4(this._context));
            this._values.length;
            isNaN(i.Std.time(this._context)) ||
              this._values.push(i.Std.time(this._context));
            var y = Math.min.apply(null, this._values),
              m = Math.max.apply(null, this._values);
            s = m;
            var u = new Date(
              a + "-" + d + "-" + c + " " + _ + ":" + h
            ).getTime();
            if (((start = !!(s >= u)), !isNaN(i.Std.time(this._context)))) {
              (volumesrc = i.Std.volume(this._context)),
                start
                  ? (firstvaluesArr.push(r), volumevaluesArr.push(volumesrc))
                  : ((firstvaluesArr = []), (volumevaluesArr = []));
              var x = 0,
                S = 0;
              start &&
                (0 < firstvaluesArr.length && (x = firstvaluesArr[0]),
                0 < volumevaluesArr.length && (S = volumevaluesArr[0]),
                (e = r),
                (o = i.Std.volume(this._context)),
                (pinecum_src = i.Std.cum(e * o, this._context)),
                (pinecum_vol = i.Std.cum(o, this._context)),
                (testSrc = start ? pinecum_src + x * S : ""),
                (testVol = start ? pinecum_vol + S : ""),
                (l = testSrc / testVol));
            }
            return [l];
          });
      },
    }
  );
}
function Anchored_VWAP(i) {
  return (
    (getLastTradingDate = getAdjustedDate()),
    (datearr = spiltDate(getLastTradingDate)),
    (default_year_val = datearr.year),
    (default_month_val = datearr.month),
    (default_day_val = datearr.day),
    {
      name: "Anchored VWAP",
      metainfo: {
        _metainfoVersion: 40,
        id: "Anchored_VWAP@tv-basicstudies-1",
        scriptIdPart: "",
        name: "IV",
        description: "Anchored VWAP (iCharts)",
        shortDescription: "Anchored VWAP (iCharts)",
        isTVScript: !1,
        isTVScriptStub: !1,
        is_hidden_study: !1,
        is_price_study: !0,
        plots: [{ id: "IV_Color", type: "line" }],
        defaults: {
          styles: { plot: { plottype: 0, visible: !0, transparency: "0" } },
          inputs: {
            Src_id: "hlc3",
            Year_id: default_year_val,
            Month_id: default_month_val,
            Day_id: default_day_val,
            Hour_id: "09",
            Minute_id: "15",
          },
        },
        styles: { plot: { title: "AVWAP", type: "line" } },
        inputs: [
          { id: "Src_id", name: "Src", type: "source" },
          {
            id: "Year_id",
            name: "Year",
            title: "Year",
            type: "integer",
            min: 1,
            max: 2099,
          },
          {
            id: "Month_id",
            name: "Month",
            title: "Month",
            type: "integer",
            min: 1,
            max: 12,
            step: 1,
          },
          {
            id: "Day_id",
            name: "Day",
            title: "Day",
            type: "integer",
            min: 1,
            max: 31,
            step: 1,
          },
          {
            id: "Hour_id",
            name: "Hour",
            title: "Hour",
            type: "integer",
            min: 0,
            max: 23,
            step: 1,
          },
          {
            id: "Minute_id",
            name: "Minute",
            title: "Minute",
            type: "integer",
            min: 0,
            max: 59,
            step: 1,
          },
        ],
        plots: [{ id: "plot", type: "line" }],
      },
      constructor: function () {
        (this.f_0 = function (e) {
          var t = this._context.new_var(e);
          return this._context.new_var(t.get(1));
        }),
          (this.f_1 = function (e) {
            return "open" === e
              ? "open"
              : "high" === e
              ? "high"
              : "low" === e
              ? "low"
              : "close" === e
              ? "close"
              : "h12" === e
              ? "h12"
              : "h1c3" === e
              ? "h1c3"
              : "ohlc4" === e
              ? "ohlc4"
              : "h1c3";
          }),
          (this.init = function (n, t) {
            (this._context = n),
              (this._input = t),
              (this._values = []),
              (firstvaluesArr = []),
              (volumevaluesArr = []),
              (getallvaluesArr = []),
              (timeArr = []),
              (return_val = [0]),
              (test1 = 0),
              (test2 = 0),
              (pinecum_vol2 = 0),
              (start = !1),
              this._context.new_sym(
                i.Std.ticker(this._context),
                i.Std.period(this._context),
                i.Std.period(this._context)
              );
          }),
          (this.main = function (n, t) {
            (this._context = n), (this._input = t);
            var e,
              o,
              l,
              s,
              r,
              p = t(0),
              c = t(1),
              a = t(2),
              d = t(3),
              _ = t(4),
              h = t(5);
            "open" == p && (r = i.Std.open(this._context)),
              "high" == p && (r = i.Std.high(this._context)),
              "low" == p && (r = i.Std.low(this._context)),
              "close" == p && (r = i.Std.close(this._context)),
              "hl2" == p && (r = i.Std.hl2(this._context)),
              "hlc3" == p && (r = i.Std.hlc3(this._context)),
              "ohlc4" == p && (r = i.Std.ohlc4(this._context));
            var y = new Date(Date.UTC(c, a - 1, d, _, h)),
              m = y.getTime(),
              u = new Date(new Date(m).getTime() + -19800000),
              x = u.getTime(),
              S = this._values.length;
            isNaN(i.Std.time(this._context)) ||
              this._values.push(i.Std.time(this._context));
            var v = Math.min.apply(null, this._values),
              g = Math.max.apply(null, this._values);
            return (
              (s = g),
              (start = !!(s >= x)),
              (volumesrc = i.Std.volume(this._context)),
              start
                ? (firstvaluesArr.push(r),
                  volumevaluesArr.push(volumesrc),
                  (e = r),
                  (o = i.Std.volume(this._context)))
                : ((firstvaluesArr = []), (volumevaluesArr = [])),
              (pinecum_src = i.Std.cum(e * o, this._context)),
              (pinecum_vol = i.Std.cum(o, this._context)),
              start && (l = pinecum_src / pinecum_vol),
              [l]
            );
          });
      },
    }
  );
}

function callOpenInterest(t) {
  return {
    name: "callOpenInterest",
    metainfo: {
      _metainfoVersion: 40,
      id: "callOpenInterest@tv-basicstudies-1",
      scriptIdPart: "",
      name: "callOpenInterest",
      description: "Call Open Interest (iCharts)",
      shortDescription: "Call Open Interest (iCharts)",
      is_hidden_study: !1,
      is_price_study: !1,
      isCustomIndicator: !1,
      plots: [
        { id: "OI_Color", type: "line" },
        { id: "MA_Color", type: "line" },
      ],
      defaults: {
        styles: {
          OI_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "red",
          },
          MA_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "blue",
          },
        },
        precision: 1,
        inputs: {
          periodsLength: 14,
          method_id: "Simple",
          EnableMovingAverage_id: !1,
        },
      },
      styles: {
        OI_Color: { title: "OI Color", type: "line" },
        MA_Color: { title: "MA Color", type: "line" },
      },
      inputs: [
        {
          id: "method_id",
          type: "text",
          name: "Method",
          defval: "Simple",
          options: ["Simple", "Exponential", "Weighted"],
        },
        {
          id: "periodsLength",
          type: "integer",
          name: "periods Length",
          defval: 14,
          min: 1,
          max: 1e3,
        },
        {
          id: "EnableMovingAverage_id",
          type: "bool",
          name: "Enable Moving Average",
          defval: !1,
        },
      ],
    },
    constructor: function () {
      (this.init = function (e, i) {
        (this._context = e), (this._input = i);
        var n = t.Std.ticker(this._context) + "_CALLOI";
        (prev = 0),
          (callOpenInterest_value = 0),
          this._context.new_sym(
            n,
            t.Std.period(this._context),
            t.Std.period(this._context),
            prev,
            callOpenInterest_value
          );
      }),
        (this.main = function (e, i) {
          (this._context = e), (this._input = i);
          var n = this._input(0),
            o = this._input(1),
            l = this._input(2);
          if (
            (this._context.select_sym(1),
            isNaN(prev) || (prev = callOpenInterest_value),
            (prev = callOpenInterest_value),
            (callOpenInterest_value = isNaN(t.Std.close(this._context))
              ? prev
              : t.Std.close(this._context)),
            !isNaN(callOpenInterest_value))
          )
            var s = this._context.new_var(callOpenInterest_value);
          else var s = this._context.new_var(prev);
          if ("Simple" == n) var r = t.Std.sma(s, o, e);
          else if ("Exponential" == n) var r = t.Std.ema(s, o, e);
          else if ("Weighted" == n) var r = t.Std.wma(s, o, e);
          return !0 == l ? [callOpenInterest_value, r] : [callOpenInterest_value];
        });
    },
  };
}


function putOpenInterest(t) {
  return {
    name: "putOpenInterest",
    metainfo: {
      _metainfoVersion: 40,
      id: "putOpenInterest@tv-basicstudies-1",
      scriptIdPart: "",
      name: "putOpenInterest",
      description: "Put Open Interest (iCharts)",
      shortDescription: "Put Open Interest (iCharts)",
      is_hidden_study: !1,
      is_price_study: !1,
      isCustomIndicator: !1,
      plots: [
        { id: "OI_Color", type: "line" },
        { id: "MA_Color", type: "line" },
      ],
      defaults: {
        styles: {
          OI_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "green",
          },
          MA_Color: {
            linestyle: 0,
            visible: !0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 40,
            color: "blue",
          },
        },
        precision: 1,
        inputs: {
          periodsLength: 14,
          method_id: "Simple",
          EnableMovingAverage_id: !1,
        },
      },
      styles: {
        OI_Color: { title: "OI Color", type: "line" },
        MA_Color: { title: "MA Color", type: "line" },
      },
      inputs: [
        {
          id: "method_id",
          type: "text",
          name: "Method",
          defval: "Simple",
          options: ["Simple", "Exponential", "Weighted"],
        },
        {
          id: "periodsLength",
          type: "integer",
          name: "periods Length",
          defval: 14,
          min: 1,
          max: 1e3,
        },
        {
          id: "EnableMovingAverage_id",
          type: "bool",
          name: "Enable Moving Average",
          defval: !1,
        },
      ],
    },
    constructor: function () {
      (this.init = function (e, i) {
        (this._context = e), (this._input = i);
        var n = t.Std.ticker(this._context) + "_PUTOI";
        (prev = 0),
          (putOpenInterest_value = 0),
          this._context.new_sym(
            n,
            t.Std.period(this._context),
            t.Std.period(this._context),
            prev,
            putOpenInterest_value
          );
      }),
        (this.main = function (e, i) {
          (this._context = e), (this._input = i);
          var n = this._input(0),
            o = this._input(1),
            l = this._input(2);
          if (
            (this._context.select_sym(1),
            isNaN(prev) || (prev = putOpenInterest_value),
            (prev = putOpenInterest_value),
            (putOpenInterest_value = isNaN(t.Std.close(this._context))
              ? prev
              : t.Std.close(this._context)),
            !isNaN(putOpenInterest_value))
          )
            var s = this._context.new_var(putOpenInterest_value);
          else var s = this._context.new_var(prev);
          if ("Simple" == n) var r = t.Std.sma(s, o, e);
          else if ("Exponential" == n) var r = t.Std.ema(s, o, e);
          else if ("Weighted" == n) var r = t.Std.wma(s, o, e);
          return !0 == l ? [putOpenInterest_value, r] : [putOpenInterest_value];
        });
    },
  };
}

function CallPutPrice(i) {
  return {
    name: "callPutPrice",
    metainfo: {
      _metainfoVersion: 0,
      id: "callPutPrice@tv-basicstudies-1",
      scriptIdPart: "",
      description: "Call & Put Price (iCharts)",
      shortDescription: "Call & Put Price (iCharts)",
      is_hidden_study: !1,
      is_price_study: !1,
      isCustomIndicator: !1,
      plots: [
        { id: "plot_0", type: "line", target: "plotcandle_0" },
        { id: "plot_1", type: "line", target: "plotcandle_0" },
      ],

      defaults: {
        styles: {
          plot_0: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "red",
          },
          plot_1: {
            linestyle: 0,
            linewidth: 1,
            plottype: 0,
            trackPrice: !1,
            transparency: 0,
            visible: !0,
            color: "green",
          },
        },
        precision: 2,
        inputs: {},
      },
      styles: {
        plot_0: { title: "Call", histogramBase: 0, joinPoints: !1 },
        plot_1: { title: "Put", histogramBase: 0, joinPoints: !1 },
      },
      inputs: [],
    },
    constructor: function () {
      this.init = function (context, inputCallback) {
        this._context = context;
        this._input = inputCallback;
        const symbol = i.Std.ticker(this._context) + "_CPP";

        prev = 0;
        OpenInterest_value = 0;

        this._context.new_sym(
          symbol,
          i.Std.period(this._context),
          i.Std.period(this._context),
          prev,
          OpenInterest_value
        );
      };

      this.main = function (context, inputCallback) {
        this._context = context;
        this._input = inputCallback;
        this._context.select_sym(1);
        let call = i.Std.open(this._context);
        let put = i.Std.high(this._context);

          return [call, put];
      };
    },
  };
}
